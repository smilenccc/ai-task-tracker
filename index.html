<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ä»»å‹™çµ±è¨ˆç³»çµ± - å³æ™‚åŒæ­¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .sync-status {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .sync-status.syncing {
            background: rgba(59, 130, 246, 0.3);
        }

        .sync-status.success {
            background: rgba(16, 185, 129, 0.3);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-card.completed .number {
            color: #10b981;
        }

        .stat-card.pending .number {
            color: #f59e0b;
        }

        .stat-card.in-progress .number {
            color: #3b82f6;
        }

        .main-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .task-item {
            background: #f8fafc;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            transition: all 0.3s;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .task-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }

        .task-item.completed {
            border-left-color: #10b981;
            opacity: 0.7;
        }

        .task-item.pending {
            border-left-color: #f59e0b;
        }

        .task-item.in-progress {
            border-left-color: #3b82f6;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }

        .task-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .status-completed {
            background: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-in-progress {
            background: #dbeafe;
            color: #1e40af;
        }

        .task-description {
            color: #666;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .task-meta {
            display: flex;
            gap: 15px;
            font-size: 0.85em;
            color: #999;
        }

        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #999;
        }

        .empty-state .icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 1.2em;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .info-box h4 {
            color: #1e40af;
            margin-bottom: 5px;
        }

        .info-box p {
            color: #1e3a8a;
            font-size: 0.9em;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            
            .dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¤– AI ä»»å‹™çµ±è¨ˆç³»çµ±</h1>
            <p>è‡ªå‹•è¿½è¹¤ Telegram äº¤è¾¦ä»»å‹™</p>
            <div class="sync-status" id="syncStatus">
                ğŸ”„ è¼‰å…¥ä¸­...
            </div>
        </header>

        <div class="dashboard">
            <div class="stat-card">
                <h3>ç¸½ä»»å‹™æ•¸</h3>
                <div class="number" id="totalTasks">-</div>
            </div>
            <div class="stat-card completed">
                <h3>å·²å®Œæˆ</h3>
                <div class="number" id="completedTasks">-</div>
            </div>
            <div class="stat-card in-progress">
                <h3>é€²è¡Œä¸­</h3>
                <div class="number" id="inProgressTasks">-</div>
            </div>
            <div class="stat-card pending">
                <h3>å¾…è™•ç†</h3>
                <div class="number" id="pendingTasks">-</div>
            </div>
        </div>

        <!-- å¿«æ·é€£çµå€åŸŸ -->
        <div style="display: flex; gap: 15px; margin: 20px 0; flex-wrap: wrap; justify-content: center;">
            <a href="purchases.html" style="background: white; padding: 15px 30px; border-radius: 10px; text-decoration: none; color: #667eea; font-weight: 500; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s; display: flex; align-items: center; gap: 10px; hover: transform: translateY(-2px);">
                <span style="font-size: 1.5em;">ğŸ’³</span>
                <span>è³¼ç‰©è¨˜éŒ„</span>
            </a>
        </div>

        <div class="main-content">
            <div class="info-box">
                <h4>ğŸ’¡ ä½¿ç”¨èªªæ˜</h4>
                <p>é€™å€‹ç³»çµ±æœƒè‡ªå‹•è¨˜éŒ„ä½ åœ¨ Telegram äº¤è¾¦çµ¦ AI çš„æ‰€æœ‰ä»»å‹™ã€‚æ¯ç•¶ä½ äº¤è¾¦æ–°ä»»å‹™ï¼Œç³»çµ±æœƒè‡ªå‹•æ›´æ–°ã€‚é»æ“Šã€Œé‡æ–°æ•´ç†ã€å¯æ‰‹å‹•æ›´æ–°è³‡æ–™ã€‚</p>
            </div>

            <h2 class="section-title">
                ğŸ“‹ ä»»å‹™åˆ—è¡¨
                <button class="refresh-btn" onclick="loadTasks()">ğŸ”„ é‡æ–°æ•´ç†</button>
            </h2>
            <div id="taskList">
                <div class="loading">è¼‰å…¥ä»»å‹™è³‡æ–™ä¸­</div>
            </div>
        </div>
    </div>

    <script>
        // ä»»å‹™ç®¡ç†ç³»çµ± - å¾ GitHub è®€å–
        class TaskTrackerSync {
            constructor() {
                this.tasks = [];
                this.dataUrl = 'tasks.json';
                this.init();
            }

            async init() {
                await this.loadTasks();
                // æ¯ 30 ç§’è‡ªå‹•é‡æ–°æ•´ç†
                setInterval(() => this.loadTasks(), 30000);
            }

            async loadTasks() {
                try {
                    this.updateSyncStatus('syncing', 'ğŸ”„ åŒæ­¥ä¸­...');
                    
                    // åŠ ä¸Šæ™‚é–“æˆ³é¿å…å¿«å–
                    const response = await fetch(`${this.dataUrl}?t=${Date.now()}`);
                    
                    if (!response.ok) {
                        throw new Error('ç„¡æ³•è¼‰å…¥è³‡æ–™');
                    }
                    
                    const data = await response.json();
                    this.tasks = data.tasks || [];
                    
                    this.renderTasks();
                    this.updateStats();
                    this.updateSyncStatus('success', `âœ“ å·²åŒæ­¥ (${this.formatTime(data.lastUpdated)})`);
                    
                } catch (error) {
                    console.error('è¼‰å…¥ä»»å‹™å¤±æ•—:', error);
                    this.updateSyncStatus('error', 'âš ï¸ åŒæ­¥å¤±æ•—');
                    this.showError();
                }
            }

            updateSyncStatus(status, text) {
                const statusEl = document.getElementById('syncStatus');
                statusEl.textContent = text;
                statusEl.className = `sync-status ${status}`;
            }

            renderTasks() {
                const taskList = document.getElementById('taskList');
                
                if (this.tasks.length === 0) {
                    taskList.innerHTML = `
                        <div class="empty-state">
                            <div class="icon">ğŸ“­</div>
                            <h3>é‚„æ²’æœ‰ä»»å‹™è¨˜éŒ„</h3>
                            <p>ç•¶ä½ åœ¨ Telegram äº¤è¾¦ä»»å‹™çµ¦ AI æ™‚ï¼Œä»»å‹™æœƒè‡ªå‹•å‡ºç¾åœ¨é€™è£¡</p>
                        </div>
                    `;
                    return;
                }

                // æŒ‰æ™‚é–“æ’åºï¼ˆæœ€æ–°åœ¨å‰ï¼‰
                const sortedTasks = [...this.tasks].sort((a, b) => 
                    new Date(b.createdAt) - new Date(a.createdAt)
                );

                taskList.innerHTML = sortedTasks.map(task => `
                    <div class="task-item ${task.status}">
                        <div class="task-header">
                            <div class="task-title">${this.escapeHtml(task.title)}</div>
                            <span class="task-status status-${task.status}">
                                ${this.getStatusText(task.status)}
                            </span>
                        </div>
                        ${task.description ? `<div class="task-description">${this.escapeHtml(task.description)}</div>` : ''}
                        <div class="task-meta">
                            <span>ğŸ“ ${task.category}</span>
                            <span>ğŸ“… ${this.formatDate(task.createdAt)}</span>
                            <span>ğŸ’¬ ${task.source}</span>
                        </div>
                        ${task.detailUrl ? `
                        <div class="task-actions" style="margin-top: 15px;">
                            <a href="${task.detailUrl}" class="btn btn-detail" style="display: inline-block; background: #667eea; color: white; text-decoration: none; padding: 10px 20px; border-radius: 5px; font-size: 0.9em; transition: all 0.3s;">
                                ğŸ“„ æŸ¥çœ‹è©³æƒ… â†’
                            </a>
                        </div>
                        ` : ''}
                    </div>
                `).join('');
            }

            updateStats() {
                document.getElementById('totalTasks').textContent = this.tasks.length;
                document.getElementById('completedTasks').textContent = 
                    this.tasks.filter(t => t.status === 'completed').length;
                document.getElementById('inProgressTasks').textContent = 
                    this.tasks.filter(t => t.status === 'in-progress').length;
                document.getElementById('pendingTasks').textContent = 
                    this.tasks.filter(t => t.status === 'pending').length;
            }

            showError() {
                const taskList = document.getElementById('taskList');
                taskList.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">âš ï¸</div>
                        <h3>ç„¡æ³•è¼‰å…¥ä»»å‹™è³‡æ–™</h3>
                        <p>è«‹ç¨å¾Œå†è©¦ï¼Œæˆ–é»æ“Šä¸Šæ–¹çš„é‡æ–°æ•´ç†æŒ‰éˆ•</p>
                    </div>
                `;
            }

            getStatusText(status) {
                const statusMap = {
                    'pending': 'å¾…è™•ç†',
                    'in-progress': 'é€²è¡Œä¸­',
                    'completed': 'å·²å®Œæˆ'
                };
                return statusMap[status] || status;
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('zh-TW', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            formatTime(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleTimeString('zh-TW', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // åˆå§‹åŒ–ç³»çµ±
        let tracker;
        
        function loadTasks() {
            if (tracker) {
                tracker.loadTasks();
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            tracker = new TaskTrackerSync();
        });
    </script>
</body>
</html>
